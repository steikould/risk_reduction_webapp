<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integration Example - Power Consumption Component</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://rsms.me/">
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <link rel="stylesheet" href="professional.css">
    <style>
        .integration-nav {
            background-color: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
            margin-bottom: 2rem;
        }

        .integration-sidebar {
            background-color: var(--surface);
            border-right: 1px solid var(--border);
            padding: 1.5rem;
            min-height: calc(100vh - 80px);
        }

        .integration-main {
            padding: 2rem;
        }

        .menu-item {
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .menu-item:hover {
            background-color: rgba(88, 166, 255, 0.1);
        }

        .menu-item.active {
            background-color: var(--primary);
            color: white;
        }
    </style>
</head>
<body>
    <!-- Top Navigation -->
    <div class="integration-nav">
        <div class="flex items-center justify-between max-w-7xl mx-auto">
            <h1 class="text-xl font-bold">My Energy Management Dashboard</h1>
            <div class="flex gap-4">
                <button class="button outline">Settings</button>
                <button class="button outline">Help</button>
            </div>
        </div>
    </div>

    <!-- Main Layout -->
    <div class="flex max-w-7xl mx-auto">
        <!-- Sidebar -->
        <div class="integration-sidebar" style="width: 250px;">
            <nav>
                <div class="menu-item active" data-view="dashboard">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline; margin-right: 8px;"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
                    Dashboard
                </div>
                <div class="menu-item" data-view="power-consumption">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline; margin-right: 8px;"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
                    Power Consumption
                </div>
                <div class="menu-item" data-view="fuel-blending">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline; margin-right: 8px;"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                    Fuel Blending
                </div>
                <div class="menu-item" data-view="reports">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline; margin-right: 8px;"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/></svg>
                    Reports
                </div>
            </nav>
        </div>

        <!-- Main Content Area -->
        <div class="integration-main flex-1">
            <!-- Dashboard View -->
            <div id="view-dashboard" class="view-content">
                <h2 class="text-2xl font-bold mb-4">Dashboard Overview</h2>
                <div class="grid grid-cols-3 gap-4 mb-6">
                    <div class="card">
                        <div class="card-content">
                            <div class="text-sm text-secondary mb-1">Total Power Usage</div>
                            <div class="text-2xl font-bold">2,847 kWh</div>
                            <div class="text-sm text-success mt-1">↓ 12% from last month</div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div class="text-sm text-secondary mb-1">Active Pumps</div>
                            <div class="text-2xl font-bold">24/28</div>
                            <div class="text-sm text-secondary mt-1">85.7% capacity</div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div class="text-sm text-secondary mb-1">Efficiency Score</div>
                            <div class="text-2xl font-bold">87.3%</div>
                            <div class="text-sm text-success mt-1">↑ 3.2% improvement</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Quick Actions</h3>
                    </div>
                    <div class="card-content">
                        <div class="flex gap-2">
                            <button class="button primary" onclick="navigateToView('power-consumption')">
                                Analyze Power Consumption
                            </button>
                            <button class="button primary" onclick="navigateToView('fuel-blending')">
                                Calculate Fuel Blend
                            </button>
                            <button class="button outline">
                                Generate Report
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Power Consumption View (Component Container) -->
            <div id="view-power-consumption" class="view-content hidden">
                <div id="power-consumption-container"></div>
            </div>

            <!-- Fuel Blending View (iframe or component) -->
            <div id="view-fuel-blending" class="view-content hidden">
                <iframe
                    src="fuel_blending.html"
                    width="100%"
                    height="1200px"
                    frameborder="0"
                    style="border: none;">
                </iframe>
            </div>

            <!-- Reports View -->
            <div id="view-reports" class="view-content hidden">
                <h2 class="text-2xl font-bold mb-4">Reports</h2>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Available Reports</h3>
                    </div>
                    <div class="card-content">
                        <p class="text-secondary">Report generation coming soon...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="power_consumption_component.js"></script>
    <script>
        // Initialize the power consumption component
        let powerConsumptionInstance = null;

        function initializePowerConsumption() {
            if (powerConsumptionInstance) {
                return; // Already initialized
            }

            powerConsumptionInstance = new PowerConsumptionComponent('power-consumption-container', {
                title: 'Power Consumption Analysis',
                subtitle: 'Analyze pump efficiency and energy usage',
                onQueryComplete: (results) => {
                    console.log('Query completed with results:', results);
                    // You can do something with the results here
                },
                onAnalysisComplete: (analysis) => {
                    console.log('Analysis completed:', analysis);
                }
            });

            powerConsumptionInstance.initialize();
        }

        // Navigation handling
        function navigateToView(viewName) {
            // Hide all views
            document.querySelectorAll('.view-content').forEach(view => {
                view.classList.add('hidden');
            });

            // Update menu items
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });

            // Show selected view
            const viewElement = document.getElementById(`view-${viewName}`);
            if (viewElement) {
                viewElement.classList.remove('hidden');
            }

            // Update active menu item
            const menuItem = document.querySelector(`[data-view="${viewName}"]`);
            if (menuItem) {
                menuItem.classList.add('active');
            }

            // Initialize power consumption component when navigating to it
            if (viewName === 'power-consumption' && !powerConsumptionInstance) {
                initializePowerConsumption();
            }
        }

        // Menu item click handlers
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', () => {
                const viewName = item.dataset.view;
                navigateToView(viewName);
            });
        });

        // Example: Access component data programmatically
        function getComponentData() {
            if (powerConsumptionInstance) {
                const results = powerConsumptionInstance.getResults();
                console.log('Component results:', results);
                return results;
            }
            return null;
        }

        // Example: Export component data
        function exportComponentData() {
            if (powerConsumptionInstance) {
                powerConsumptionInstance.exportCSV();
            }
        }

        // Example: Set custom data to component
        function loadCustomData() {
            if (powerConsumptionInstance) {
                const customData = [
                    { timestamp: '2025-10-20 10:00:00', location: 'Station A', value: 125.5 },
                    { timestamp: '2025-10-20 11:00:00', location: 'Station B', value: 98.3 }
                ];
                powerConsumptionInstance.setData(customData);
            }
        }
    </script>
</body>
</html>
